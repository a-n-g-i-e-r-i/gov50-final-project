---
title: "Gov 50 Final Project"
author: "Tristan Angieri"
description: "Psychedelic Research Project"
output:
  distill::distill_article:
    self_contained: false
---



## Project thoughts

I am interested in exploring (a) research question(s) related to the human experience of psychedelics, particularly the affective and phenomenological effects. In terms of data sources, I believe the most likely ones may be Erowid.org, https://www.psychedelicdata.io/about%3FhsLang=en.html, or Fireside Project. My main concern is getting permission to use the data, and ensuring that it passes muster with the IRB.

## Proposal

### Research Question
How does the age of initiation and frequency of LSD use differ between urban and rural areas in the U.S. in 2021, and how does this relate to the recency of LSD use?

### Hypothesis
Individuals in urban areas might initiate LSD use at a younger age compared to those in rural areas due to increased exposure and accessibility. Furthermore, the frequency of LSD use in the past year and the recency of its use might be influenced by the age of initiation, with earlier initiation potentially leading to more frequent and recent use.

### Explanatory Variables of Interest:

#### Geographical Location (Rural vs. Urban):
Variable: RURURB00
Description: "RURAL OR URBAN SEGMENT"

#### Age of Initiation of LSD Use:
Variable: LSDAGE
Description: "AGE WHEN FIRST USED LSD"
Outcome Variables of Interest:

#### Frequency of LSD Use in the Past Year:
Variable: LSDYR
Description: "RC-LSD - PAST YEAR USE"

#### Recency of LSD Use:
Variable: LSDREC
Description: "TIME SINCE LAST USED LSD"

### Control Variables:

#### Ever Used LSD:
Variable: LSDFLAG
Description: "RC-LSD - EVER USED"

#### Age Last Used LSD:
Variable: LSDAGLST
Description: "HOW OLD WERE YOU THE LAST TIME USED LSD"
Expected Observations:

If the data reveals that individuals from urban areas initiate LSD use at a younger age and have a higher frequency of use in the past year compared to those from rural areas, it would support the hypothesis.

A significant positive relationship between the age of initiation (LSDAGE) and the recency of use (LSDREC) would suggest that earlier initiation leads to more recent use.

### Statistical Analysis
A regression analysis will be conducted with LSDYR and LSDREC as the dependent variables, and RURURB00 and LSDAGE as the main independent variables. The regression will control for ever using LSD and the age of last use. This will allow us to understand the relationship between the age of initiation, geographical location, and the frequency and recency of LSD use.

### Data Source
The data for this study will be sourced from the ["National Survey on Drug Use and Health 2021 (NSDUH-2021-DS0001)"](https://www.datafiles.samhsa.gov/dataset/national-survey-drug-use-and-health-2021-nsduh-2021-ds0001). The [dataset's specific variables](https://www.datafiles.samhsa.gov/sites/default/files/NSDUH_files/RDAS/RDAS_Comparability.xlsx) will provide a comprehensive perspective on the research question.

```{r}
library(dplyr)
nsduh <- load("./NSDUH_2021.RData")

#https://www.r-bloggers.com/2012/11/analyze-the-national-survey-on-drug-use-and-health-nsduh-with-r/
#http://asdfree.com/national-study-on-drug-use-and-health-nsduh.html
#https://github.com/ajdamico/lodown
# nsduh_tib <- as_tibble(nsduh)
# 
nsduh
```

```{r}
# PUF2021_100622
lsd_use <- PUF2021_100622 |>
  mutate(
    metro_level = case_when(
      COUTYP4 == 1 ~ "Large Metro",
      COUTYP4 == 2 ~ "Small Metro",
      COUTYP4 == 3 ~ "Non Metro"
    )
  ) |>
  select(
    # metro level
    metro_level,
    # respondent age
    AGE3,
    # population density
    PDEN10,
    # metro/non-metro
    COUTYP4,
    # age of first lsd age
    lsdage,
    # ever used lsd (1)
    lsdflag,
    # lsd age last use
    lsdaglst,
    # year of last lsd use
    lsdylu,
    # TIME SINCE LAST USED LSD
    lsdrec,
    # Ever used psilocybin
    psilcyever,
    # ever used psilocybin
    psilcy,
    # ever used hallucinogens (DMTAMTFXY, ECSTMOLLY, HALLUCOTH, KETMINESK, LSD, MESC, PCP, PEYOTE, PSILCY, SALVIADIV)
    hallucevr,
    # age of first hallucage
    hallucage
  )
```

```{r}
library(tidyverse)
```
#### Age of First Hallucinogen Use
This analysis reveals that the median age of first hallucinogen use among respondents is approximately 19 years, representing the midpoint of the distribution. Approximately 25% of respondents start using hallucinogens before or at age 17 (Q1), while another quarter initiate use at or after age 21 (Q3), indicating quartile boundaries. The mean age of initiation, around 19.65 years, closely aligns with the median, implying a relatively symmetrical distribution. The histogram closely resembles a normal distribution with a slight right skew, indicating that most respondents commence using hallucinogens in their late teens or early twenties, with a smaller fraction initiating use at older ages.
```{r}
filtered_lsd_use <- lsd_use |>
  filter(hallucage < 69)

summary_stats <- filtered_lsd_use |>
  summarise(
    Median = median(hallucage),
    Q1 = quantile(hallucage, 0.25),
    Q3 = quantile(hallucage, 0.75),
    Mean = mean(hallucage),
    SD = sd(hallucage),
    Min = min(hallucage),
    Max = max(hallucage)
  )

summary_stats

lsd_use_plot <- filtered_lsd_use |>
  ggplot(mapping = aes(x = hallucage)) +
  geom_histogram(binwidth = 1) +
  labs(
    title = "Age of First Hallucinogen Use",
    x = "Age of respondent at first Hallucinogen use (years)",
    y = "Count"
  ) +
  geom_vline(aes(xintercept = mean(hallucage)), color = "indianred") +
  geom_vline(aes(xintercept = median(hallucage)), color = "dodgerblue")

lsd_use_plot
```
#### Age of First Hallucinogen Use by Metrolevel
The boxplot analysis reveals variations in the age of first hallucinogen use across different metro level areas. In Large Metro areas, the median age of initiation is around 19 years, while in Non Metro and Small Metro areas, it's about 18 years. The first quartile age (25th percentile) indicates that a quarter of individuals in Non Metro areas start using hallucinogens at a younger age, at approximately 16 years, compared to the other groups. The third quartile age (75th percentile) shows that the majority in all three areas initiate use by their early twenties, with Large Metro areas slightly later at around 22 years. These findings highlight regional differences in the timing of first hallucinogen use, with individuals in Large Metro areas tending to initiate use slightly later on average.
```{r}
lsd_use_box_plot <- filtered_lsd_use |>
  filter(
    hallucage < 69
  ) |>
  ggplot(
    mapping = aes(
      x = hallucage,
      fill = metro_level
    )
  ) +
geom_boxplot() +
  labs(
    title = "Age of First Hallucinogen Use by Metro Level",
    x = "Metro Level",
    y = "Age at first Hallucinogen use (years)"
  )

lsd_use_box_plot

summary_stats <- lsd_use |>
  filter(hallucage < 69) |>
  group_by(metro_level) |>
  summarize(
    Median = median(hallucage),
    Q1 = quantile(hallucage, 0.25),
    Q3 = quantile(hallucage, 0.75)
  )

summary_stats
```
#### Hallucinogen lifetime use and metro level
Whether a respondent has ever taken psychedelics (hallucevr) does not appear to have a significant impact on the type of county (COUTYP4) in which they reside. The coefficient for hallucevr is almost zero, indicating that there is virtually no association between these two variables in the model.
```{r}
fit_2 <- lm(COUTYP4 ~ hallucevr, data = lsd_use)

fit_2 |>
  broom::tidy() |>
  select(term, estimate) |>  
  knitr::kable(digits = 2)
```

```{r}
metro_hall_plot <- filtered_lsd_use |>
  group_by(metro_level) |>
  summarize(
    avg_hallucage = mean(hallucage)
  ) |>
  ggplot(mapping = aes(x = fct_reorder(metro_level, avg_hallucage), y = avg_hallucage, fill = metro_level)) +
  geom_col() +
  labs(
    title = "County metro/nonmetro status level and average age of first Hallucinogen use",
    x = "COUNTY METRO/NONMETRO STATUS (2013 3-LEVEL)",
    y = "Average Age of respondent at first Hallucinogen use (years)"
  )

metro_hall_plot
```

